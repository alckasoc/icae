  0%|                                                                          | 0/20 [00:00<?, ?it/s]
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
  5%|███▎                                                              | 1/20 [00:03<01:04,  3.41s/it]
{'loss': 6.5, 'grad_norm': 5.685534477233887, 'learning_rate': 4.75e-05, 'epoch': 1.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 6.4062, 'grad_norm': 5.651377201080322, 'learning_rate': 4.5e-05, 'epoch': 2.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 6.2812, 'grad_norm': 5.776406288146973, 'learning_rate': 4.25e-05, 'epoch': 3.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 6.0625, 'grad_norm': 5.83684778213501, 'learning_rate': 4e-05, 'epoch': 4.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 5.8438, 'grad_norm': 5.8847880363464355, 'learning_rate': 3.7500000000000003e-05, 'epoch': 5.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 5.5625, 'grad_norm': 5.724120140075684, 'learning_rate': 3.5e-05, 'epoch': 6.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 5.3438, 'grad_norm': 5.595716953277588, 'learning_rate': 3.2500000000000004e-05, 'epoch': 7.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 5.125, 'grad_norm': 5.370546817779541, 'learning_rate': 3e-05, 'epoch': 8.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 4.9375, 'grad_norm': 5.171005725860596, 'learning_rate': 2.7500000000000004e-05, 'epoch': 9.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 4.7812, 'grad_norm': 4.974418640136719, 'learning_rate': 2.5e-05, 'epoch': 10.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 4.625, 'grad_norm': 4.783560752868652, 'learning_rate': 2.25e-05, 'epoch': 11.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 4.4688, 'grad_norm': 4.543671607971191, 'learning_rate': 2e-05, 'epoch': 12.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 4.3125, 'grad_norm': 4.333775520324707, 'learning_rate': 1.75e-05, 'epoch': 13.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 4.2188, 'grad_norm': 4.2058024406433105, 'learning_rate': 1.5e-05, 'epoch': 14.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 4.125, 'grad_norm': 4.1392974853515625, 'learning_rate': 1.25e-05, 'epoch': 15.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 4.0625, 'grad_norm': 4.033684253692627, 'learning_rate': 1e-05, 'epoch': 16.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 3.9844, 'grad_norm': 3.9388673305511475, 'learning_rate': 7.5e-06, 'epoch': 17.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 3.9375, 'grad_norm': 3.899104595184326, 'learning_rate': 5e-06, 'epoch': 18.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 3.8906, 'grad_norm': 3.838980197906494, 'learning_rate': 2.5e-06, 'epoch': 19.0}
input_ids shape:  torch.Size([1, 243])
prompt_answer_ids shape:  torch.Size([1, 306])
labels shape:  torch.Size([1, 306])
num_segments:  61
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 306, 2048])
max_compressed_length:  61
compress_outputs shape:  torch.Size([61, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 132
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
===============Segment 33=======================
start_idx: 132 | end_idx: 136
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 33.
===============Segment 33 END=======================
===============Segment 34=======================
start_idx: 136 | end_idx: 140
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 34.
===============Segment 34 END=======================
===============Segment 35=======================
start_idx: 140 | end_idx: 144
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 35.
===============Segment 35 END=======================
===============Segment 36=======================
start_idx: 144 | end_idx: 148
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 36.
===============Segment 36 END=======================
===============Segment 37=======================
start_idx: 148 | end_idx: 152
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 37.
===============Segment 37 END=======================
===============Segment 38=======================
start_idx: 152 | end_idx: 156
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 38.
===============Segment 38 END=======================
===============Segment 39=======================
start_idx: 156 | end_idx: 160
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 39.
===============Segment 39 END=======================
===============Segment 40=======================
start_idx: 160 | end_idx: 164
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 40.
===============Segment 40 END=======================
===============Segment 41=======================
start_idx: 164 | end_idx: 168
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 41.
===============Segment 41 END=======================
===============Segment 42=======================
start_idx: 168 | end_idx: 172
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 42.
===============Segment 42 END=======================
===============Segment 43=======================
start_idx: 172 | end_idx: 176
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 43.
===============Segment 43 END=======================
===============Segment 44=======================
start_idx: 176 | end_idx: 180
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 44.
===============Segment 44 END=======================
===============Segment 45=======================
start_idx: 180 | end_idx: 184
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 45.
===============Segment 45 END=======================
===============Segment 46=======================
start_idx: 184 | end_idx: 188
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 46.
===============Segment 46 END=======================
===============Segment 47=======================
start_idx: 188 | end_idx: 192
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 47.
===============Segment 47 END=======================
===============Segment 48=======================
start_idx: 192 | end_idx: 196
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 48.
===============Segment 48 END=======================
===============Segment 49=======================
start_idx: 196 | end_idx: 200
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 49.
===============Segment 49 END=======================
===============Segment 50=======================
start_idx: 200 | end_idx: 204
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 50.
===============Segment 50 END=======================
===============Segment 51=======================
start_idx: 204 | end_idx: 208
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 51.
===============Segment 51 END=======================
===============Segment 52=======================
start_idx: 208 | end_idx: 212
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 52.
===============Segment 52 END=======================
===============Segment 53=======================
start_idx: 212 | end_idx: 216
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 53.
===============Segment 53 END=======================
===============Segment 54=======================
start_idx: 216 | end_idx: 220
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 54.
===============Segment 54 END=======================
===============Segment 55=======================
start_idx: 220 | end_idx: 224
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 55.
===============Segment 55 END=======================
===============Segment 56=======================
start_idx: 224 | end_idx: 228
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 56.
===============Segment 56 END=======================
===============Segment 57=======================
start_idx: 228 | end_idx: 232
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 57.
===============Segment 57 END=======================
===============Segment 58=======================
start_idx: 232 | end_idx: 236
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 58.
===============Segment 58 END=======================
===============Segment 59=======================
start_idx: 236 | end_idx: 240
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 59.
===============Segment 59 END=======================
===============Segment 60=======================
start_idx: 240 | end_idx: 243
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 60.
===============Segment 60 END=======================
decoder_mem_flag shape:  torch.Size([1, 306])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 306, 128256])
effective_logits shape:  torch.Size([305, 128256])
target_ids shape:  torch.Size([305])
{'loss': 3.8594, 'grad_norm': 3.8192059993743896, 'learning_rate': 0.0, 'epoch': 20.0}
{'train_runtime': 61.7679, 'train_samples_per_second': 0.324, 'train_steps_per_second': 0.324, 'train_loss': 4.91640625, 'epoch': 20.0}
***** train metrics *****
  epoch                    =       20.0
  total_flos               =        0GF
  train_loss               =     4.9164
  train_runtime            = 0:01:01.76
  train_samples_per_second =      0.324
  train_steps_per_second   =      0.324
input_ids shape:  torch.Size([1, 131])
prompt_answer_ids shape:  torch.Size([1, 166])
labels shape:  torch.Size([1, 166])
num_segments:  33
segment_length:  4
prompt_answer_embs shape:  torch.Size([1, 166, 2048])
max_compressed_length:  33
compress_outputs shape:  torch.Size([33, 2048])
===============Segment 0=======================
start_idx: 0 | end_idx: 4
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 0.
===============Segment 0 END=======================
===============Segment 1=======================
start_idx: 4 | end_idx: 8
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 1.
===============Segment 1 END=======================
===============Segment 2=======================
start_idx: 8 | end_idx: 12
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 2.
===============Segment 2 END=======================
===============Segment 3=======================
start_idx: 12 | end_idx: 16
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 3.
===============Segment 3 END=======================
===============Segment 4=======================
start_idx: 16 | end_idx: 20
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 4.
===============Segment 4 END=======================
===============Segment 5=======================
start_idx: 20 | end_idx: 24
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 5.
===============Segment 5 END=======================
===============Segment 6=======================
start_idx: 24 | end_idx: 28
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 6.
===============Segment 6 END=======================
===============Segment 7=======================
start_idx: 28 | end_idx: 32
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 7.
===============Segment 7 END=======================
===============Segment 8=======================
start_idx: 32 | end_idx: 36
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 8.
===============Segment 8 END=======================
===============Segment 9=======================
start_idx: 36 | end_idx: 40
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 9.
===============Segment 9 END=======================
===============Segment 10=======================
start_idx: 40 | end_idx: 44
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 10.
===============Segment 10 END=======================
===============Segment 11=======================
start_idx: 44 | end_idx: 48
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 11.
===============Segment 11 END=======================
===============Segment 12=======================
start_idx: 48 | end_idx: 52
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 12.
===============Segment 12 END=======================
===============Segment 13=======================
start_idx: 52 | end_idx: 56
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 13.
===============Segment 13 END=======================
===============Segment 14=======================
start_idx: 56 | end_idx: 60
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 14.
===============Segment 14 END=======================
===============Segment 15=======================
start_idx: 60 | end_idx: 64
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 15.
===============Segment 15 END=======================
===============Segment 16=======================
start_idx: 64 | end_idx: 68
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 16.
===============Segment 16 END=======================
===============Segment 17=======================
start_idx: 68 | end_idx: 72
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 17.
===============Segment 17 END=======================
===============Segment 18=======================
start_idx: 72 | end_idx: 76
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 18.
===============Segment 18 END=======================
===============Segment 19=======================
start_idx: 76 | end_idx: 80
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 19.
===============Segment 19 END=======================
===============Segment 20=======================
start_idx: 80 | end_idx: 84
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 20.
===============Segment 20 END=======================
===============Segment 21=======================
start_idx: 84 | end_idx: 88
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 21.
===============Segment 21 END=======================
===============Segment 22=======================
start_idx: 88 | end_idx: 92
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 22.
===============Segment 22 END=======================
===============Segment 23=======================
start_idx: 92 | end_idx: 96
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 23.
===============Segment 23 END=======================
===============Segment 24=======================
start_idx: 96 | end_idx: 100
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 24.
===============Segment 24 END=======================
===============Segment 25=======================
start_idx: 100 | end_idx: 104
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 25.
===============Segment 25 END=======================
===============Segment 26=======================
start_idx: 104 | end_idx: 108
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 26.
===============Segment 26 END=======================
===============Segment 27=======================
start_idx: 108 | end_idx: 112
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 27.
===============Segment 27 END=======================
===============Segment 28=======================
start_idx: 112 | end_idx: 116
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 28.
===============Segment 28 END=======================
===============Segment 29=======================
start_idx: 116 | end_idx: 120
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 29.
===============Segment 29 END=======================
===============Segment 30=======================
start_idx: 120 | end_idx: 124
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 30.
===============Segment 30 END=======================
===============Segment 31=======================
start_idx: 124 | end_idx: 128
segment_input_ids shape:  torch.Size([1, 4])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 5])
mem_flag shape:  torch.Size([1, 5])
segment_input_embedding shape:  torch.Size([1, 5, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 5, 2048])
Filled in compressed memory for memory segment 31.
===============Segment 31 END=======================
===============Segment 32=======================
start_idx: 128 | end_idx: 131
segment_input_ids shape:  torch.Size([1, 3])
append_sequence shape:  torch.Size([1, 1])
segment_input_ids shape after concat:  torch.Size([1, 4])
mem_flag shape:  torch.Size([1, 4])
segment_input_embedding shape:  torch.Size([1, 4, 2048])
Populated segment_input_embedding memory tokens
segment_compress_outputs (last hidden state) shape:  torch.Size([1, 4, 2048])
Filled in compressed memory for memory segment 32.
===============Segment 32 END=======================
decoder_mem_flag shape:  torch.Size([1, 166])
Populated decoder memory tokens with compressed outputs.
Populated decoder special memory tokens.
decoder_outputs logits shape:  torch.Size([1, 166, 128261])
effective_logits shape:  torch.Size([165, 128261])
target_ids shape:  torch.Size([165])
100%|█████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 1747.63it/s]
***** eval metrics *****
  epoch                   =       20.0
  eval_loss               =     4.4375
  eval_runtime            = 0:00:00.69
  eval_samples_per_second =       1.44
  eval_steps_per_second   =       1.44
Finished training...
